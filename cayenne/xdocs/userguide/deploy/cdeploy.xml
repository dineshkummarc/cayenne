<document>
<title>User Guide - Deployment</title>

    <properties>
        <author>Andrei Adamchik</author>
    </properties>
<navigator>
	<up>/userguide/index.html</up>
	<prev></prev>
	<next></next>
</navigator>    
<body>
    <section name="10. Deployment">        
           <subsection name="10.6 Deployment Configuration With Ant">
            <p>Normally deployment environment uses different information for the
            database connections from what was used in development. There are also 
            other cases when it is highly desirable to automate changing Cayenne 
            configuration from one database to another. Cayenne offers an Ant task
            that takes care of such things.
			</p>
            
            <subsection name="10.6.1 Cdeploy (Cayenne Deployment Configurator)" anchor="cdeploy">
			<h3>Description</h3>
			
			<p><code>Cdeploy</code> is an Ant task that configures Cayenne connection information
			in existing jar files that contain Cayenne project information. It is useful for the automation of
			deployment of Cayenne-based frameworks in different environments.
			</p>

			<h3>Parameters</h3>
			
			<table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Attribute</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Required</b></th>
				</tr>
				<tr>
					<td valign="top">src</td>
					<td valign="top">Source jar file that contains Cayenne project
					files among other things.</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">dest</td>
					<td valign="top">Destination jar file that should be generated 
					as a result of this task execution. If omitted, <i>src</i>
					is used.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">altProjectFile</td>
					<td valign="top">An alternative location of <i>cayenne.xml</i>
					file. If specified, this file will be used instead of the one
					located in the source jar file.</td>
					<td valign="top" align="center">No</td>
				</tr>
			</table>
			
			<h3>Nested Elements:</h3>
			
			<h4>node</h4>
			
			<p>One or more nested "node" elements specify connection information for the named
			nodes. All nested nodes must exist in the project, or otherwise they
			will be ignored.</p>
			
			<h4>Nested <i>node</i> Parameters:</h4>
			<table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Attribute</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Required</b></th>
				</tr>
				<tr>
					<td valign="top">name</td>
					<td valign="top">DataNode name</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">domain</td>
					<td valign="top">Parent DataDomain of this node. If omitted,
					project must have only a single domain (very common case).</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">adapter</td>
					<td valign="top">DataNode adapter.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">dataSource</td>
					<td valign="top">DataSource name to use for this node.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">file</td>
					<td valign="top">File that contains driver information.</td>
					<td valign="top" align="center">No</td>
				</tr>
			</table>
			
			<p>"dataSource" and "file" are mutually exclusive and at least one of them is required.</p>
			
			<h3>Examples:</h3>
			<p>Here is an example of using <code>Cdeploy</code> to regenerate a jar file
			called "business.jar" with connection info located in "alt.driver.xml":</p>
<source>
&amp;lt;taskdef name="cdeploy" classname="org.objectstyle.cayenne.tools.DeploymentConfigurator"/&amp;gt;
&amp;lt;cdeploy src="business.jar"&amp;gt;
    &amp;lt;node name="main-node" file="alt.driver.xml"/&amp;gt;
&amp;lt;/cdeploy&amp;gt;
</source>

			</subsection>
        </subsection>
    </section>
</body>
</document>
