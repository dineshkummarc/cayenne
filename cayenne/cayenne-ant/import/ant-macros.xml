<?xml version="1.0"?>

<!-- ================================================= -->
<!-- Reusable Macros                                   -->
<!-- ================================================= -->
<project default="...">
	
	<!-- ============================================= -->
	<!-- *** API documentation macro. ***              -->
	<!-- TODO: how can we define conditional javadoc   -->
	<!-- execution in a macro?                         -->
	<!-- ============================================= -->
	<macrodef name="api">
		
		<attribute name="destdir"/>
		<attribute name="srcref"/>
		<attribute name="classpathref"/>
		
		<sequential>
			<mkdir dir="@{destdir}"/>
			<javadoc packagenames="org.objectstyle.*" destdir="@{destdir}"
				sourcepathref="@{srcref}" classpathref="@{classpathref}"
				author="true" use="true"
				stylesheetfile="${cayenne.other}/javadoc/objectstyle-javadoc.css"
				splitindex="true" windowtitle="Cayenne API Documentation"
				overview="${cayenne.other}/javadoc/overview.html">
				
				<bottom>
					<![CDATA[<!--@@SFLOGO@@--> &nbsp; <i>Copyright &#169; 2001-2005 <a href=
					"http://objectstyle.org" target="_top">ObjectStyle.org</a> All Rights Reserved.</i>]]>
				</bottom>
			</javadoc>
		</sequential>
	</macrodef>
	
	<!-- ============================================= -->
	<!-- Compile with JDK 1.4 compatibility.           -->
	<!-- ============================================= -->
	<macrodef name="compile-1_4">
		
		<attribute name="destdir"/>
		<attribute name="srcref"/>
		<attribute name="classpathref"/>
		
		<sequential>
			<mkdir dir="@{destdir}"/>
			<javac destdir="@{destdir}" classpathref="@{classpathref}"
				optimize="on" debug="on" source="1.4" target="1.4" deprecation="on">
				
				<src refid="@{srcref}"/>
			</javac>
		</sequential>
	</macrodef>
	
	<!-- ============================================= -->
	<!-- Compile with JDK 1.5 compatibility.           -->
	<!-- ============================================= -->
	<macrodef name="compile-1_5">
		
		<attribute name="destdir"/>
		<attribute name="srcref"/>
		<attribute name="classpathref"/>
		
		<sequential>
			<mkdir dir="@{destdir}"/>
			<javac destdir="@{destdir}" classpathref="@{classpathref}"
				optimize="on" debug="on" source="1.5" target="1.5" deprecation="on">
				
				<src refid="@{srcref}"/>
			</javac>
		</sequential>
	</macrodef>
	
	<!-- ============================================= -->
	<!-- Run cgen.                                     -->
	<!-- ============================================= -->
	<macrodef name="cgen-tests">
		
		<attribute name="destdir"/>
		<attribute name="map"/>
		<attribute name="superpkg"/>
		<attribute name="client" default="false"/>
		
		<sequential>
			<taskdef name="cgen-task"
				classname="org.objectstyle.cayenne.tools.CayenneGenerator">
				<classpath refid="classpath-tests-run"/>
			</taskdef>
			
			<mkdir dir="@{destdir}"/>
			<cgen-task map="@{map}" destDir="@{destdir}" superpkg="@{superpkg}"
				client="@{client}"/>
		</sequential>
	</macrodef>
</project>