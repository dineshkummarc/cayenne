<?xml version="1.0"?>

<!-- ================================================= -->
<!-- Latest release buildfile. Called from build.xml. -->
<!-- ================================================= -->
<project default="site">

	<property name="dtd" value="${cayenne.latest}/src/cayenne/dtd"/>
	<property name="license" value="${cayenne.latest}/doc/licenses"/>
    
    <!-- ============================================= -->
    <!-- Deploys Cayenne web site locally -->
    <!-- ============================================= -->
    <target name="site" depends="dtd,license,grammar,doc,api"/>
    
    <target name="dtd" depends="check-latest">
    	<copy todir="${dist}/dtd">
    		<fileset dir="${dtd}" includes="**/*.dtd"/>
    	</copy>
    </target>
 
    <target name="license" depends="check-latest">
		<copy todir="${dist}/licenses">
    		<fileset dir="${license}" includes="**/**"/>
    	</copy>
    </target>
    
	<target name="grammar" depends="check-latest,doc">
    
    </target>
    
	<target name="doc" depends="check-latest">
    	<ant antfile="build-subproject.xml" target="doc">
    		<property name="cayenne.location" value="${cayenne.latest}"/>
    		<property name="subproject.name" value="cayenne-latest"/>
    		<property name="doc.include" value="userguide/**"/>
    	</ant>
    </target>
    
	<target name="api" depends="check-latest">
    
    </target>
    
    <target name="check-latest">
    	<available file="${cayenne.latest}" property="cayenne.latest.present"/>
    	<fail unless="cayenne.latest.present">
    	
**** FATAL:No valid Cayenne checkout. "cayenne.latest" property: "${cayenne.latest}"
    	</fail>
    </target>
</project>
